{% extends "base_assos.html" %}

{% block title %}Fiches de visite{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2>ğŸ“„ Fiches de visite â€“ {{ partenaire['nom_association'] or "â€”" }}</h2>

  <div class="mb-3">
    <a href="{{ url_for('partenaires.update_partner', partner_id=partner_id) }}"
       class="btn btn-secondary">â¬…ï¸ Retour partenaire</a>
    <a href="{{ url_for('fiches_visite.nouvelle', partner_id=partner_id) }}"
       class="btn btn-primary">â• Nouvelle fiche de visite</a>
  </div>

  {% if fiches %}
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Date de visite</th>
          <th>CAR</th>
          <th>ReÃ§u par</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for fiche in fiches %}
        <tr>
          <td>{{ fiche.get('date_visite') | datetimeformat }}</td>
          <td>{{ fiche['car'] or "â€”" }}</td>
          <td>{{ fiche['recu_par'] or "â€”" }}</td>
          <td>
            <a href="{{ url_for('fiches_visite.view', fiche_id=fiche['id']) }}" 
               class="btn btn-sm btn-outline-info">ğŸ‘ï¸ Voir</a>
            <a href="{{ url_for('fiches_visite.modifier', fiche_id=fiche['id']) }}" 
               class="btn btn-sm btn-warning">âœï¸ Modifier</a>
            <a href="{{ url_for('fiches_visite.pdf', fiche_id=fiche['id']) }}"
              class="btn btn-outline-danger btn-sm"
              target="_blank">
              ğŸ“„ PDF
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p class="text-muted">Aucune fiche de visite enregistrÃ©e pour ce partenaire.</p>
  {% endif %}
</div>
{% endblock %}
