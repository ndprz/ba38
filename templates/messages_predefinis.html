{% extends "base_assos.html" %}
{% block title %}Messages prÃ©-enregistrÃ©s{% endblock %}
{% block content %}
<div class="container mt-4">
  <h2>ğŸ“‘ Messages prÃ©-enregistrÃ©s</h2>

  {% if assoc_id %}
    <a href="{{ url_for('mail.envoi_mail', assoc_id=assoc_id) }}" class="btn btn-secondary mb-3">
      â¬…ï¸ Retour Ã  lâ€™envoi de mail
    </a>
  {% endif %}

  <!-- Formulaire ajout -->
  <form method="post" class="mb-4">
    <input type="hidden" name="assoc_id" value="{{ assoc_id or '' }}">
    <div class="mb-2">
      <label for="titre" class="form-label">Titre</label>
      <input type="text" name="titre" id="titre" class="form-control" required>
    </div>
    <div class="mb-2">
      <label for="contenu" class="form-label">Contenu</label>
      <textarea name="contenu" id="contenu" class="form-control" rows="4" required></textarea>
    </div>
    <button type="submit" class="btn btn-success">â• Ajouter</button>
  </form>

  <!-- Liste des modÃ¨les -->
  <table class="table table-striped">
    <thead>
      <tr><th>Titre</th><th>Contenu</th><th>Actions</th></tr>
    </thead>
    <tbody>
    {% for m in messages %}
      <tr>
        <td>{{ m.titre }}</td>
        <td style="white-space: pre-wrap;">{{ m.contenu }}</td>
        <td>
          <a href="{{ url_for('mail.edit_message', mid=m.id, assoc_id=assoc_id) }}" class="btn btn-sm btn-primary">âœï¸ Modifier</a>
          <form method="post" action="{{ url_for('mail.delete_message', mid=m.id, assoc_id=assoc_id) }}" style="display:inline;">
            <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Supprimer ce message ?');">ğŸ—‘ï¸ Supprimer</button>
          </form>
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
