<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Module Distribution{% endblock %}</title>

    <link rel="icon" type="image/png"
          href="{{ url_for('static', filename='images/logo-circle-orange.svg') }}">

    <link rel="stylesheet"
          href="{{ url_for('static', filename='css/bootstrap-custom.css') }}">
    <link rel="stylesheet"
          href="{{ url_for('static', filename='css/public.css') }}">

    <style>
        body { background-color: #f5f5f5; }

        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 20px;
            background-color: #fff;
            border-bottom: 2px solid #ddd;
        }

        .user-info {
            font-size: 0.9rem;
        }

        footer {
            text-align: center;
            padding: 10px;
            background-color: #fff;
            border-top: 2px solid #ddd;
            margin-top: 40px;
        }
    </style>
</head>

<body>

<header>

    <!-- MODE TEST -->
    {% if session.get('test_user') %}
        <div class="badge bg-danger">
            ‚ö†Ô∏è MODE TEST
        </div>
    {% endif %}

    <!-- Bloc gauche -->
    <div class="header-left">
        <img src="{{ url_for('static', filename='images/logo-circle-orange.svg') }}"
            alt="Logo BA38"
            class="header-logo">

        <div class="header-text">
            <strong>BA38</strong>
            <span class="header-subtitle">
                Plateforme distribution
            </span>
        </div>
    

        {% if env_name == "dev" %}
            <span class="badge bg-danger ms-2">D√©veloppement</span>
        {% endif %}
    </div>  <!-- fermeture header-left -->

    <!-- Navigation centrale -->
    <nav class="main-nav">

        <a href="{{ url_for('index') }}" class="fw-bold text-decoration-none">
            Accueil
        </a>

        {% if has_access("distribution", "lecture") %}
            <a href="{{ url_for('distribution.distribution_main') }}">
                Tableau de bord
            </a>

            <a href="{{ url_for('distribution.visualisation_stock') }}">
                Stock
            </a>
        {% endif %}

        {% if has_access("distribution", "ecriture") %}
            <a href="{{ url_for('distribution.mouvements_stocks_depot') }}">
                Mouvements
            </a>
        {% endif %}
    </nav>
    
    <!-- Bloc droit -->
    <div class="header-right">

        {% if is_admin_global() %}
            <a href="{{ url_for('debug_bp.debug_console') }}"
               class="btn btn-outline-secondary btn-sm">
                üêû Debug
            </a>
        {% endif %}

        {% if current_user.is_authenticated %}
            <div class="user-info ms-3">
                Connect√© : {{ current_user.email }}
                <a href="{{ url_for('logout') }}"
                   class="btn btn-sm btn-danger ms-2">
                    D√©connexion
                </a>
            </div>
        {% endif %}

    </nav>
</header>

{% include "_flash.html" %}

<!-- S√©curit√© : blocage si pas droit -->
{% if not has_access("distribution", "lecture") %}
    <div class="container mt-5">
        <div class="alert alert-danger text-center">
            ‚õî Acc√®s non autoris√© au module Distribution.
        </div>
    </div>
{% else %}

<main class="container mt-4">
    {% block content %}{% endblock %}
</main>

{% endif %}


<footer>
    &copy; 2026 BA38 ‚Äî Distribution ‚Äî Version {{ version }}
</footer>

<script src="{{ url_for('static', filename='js/jquery-3.5.1.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>

<script src="{{ url_for('static', filename='js/layout.js') }}"></script>



{% block scripts %}{% endblock %}

</body>
</html>
