<div class="card mb-3">
  <div class="card-header bg-warning">
    1) Mise Ã  jour de lâ€™annexe 1bis de la convention de partenariat
  </div>
  <div class="card-body">
    <p class="text-muted">
      VÃ©rifier que lâ€™annexe 1bis est bien remplie, Ã  jour, et disponible dans le Drive.
    </p>

    {% if lecture_seule %}
      <p><strong>Lien vers le Drive :</strong>
        {% if fiche.get("drive_link") %}
          <a href="{{ fiche.get('drive_link') }}" target="_blank" class="btn btn-sm btn-outline-primary ms-2">
            ğŸ”— Ouvrir le document
          </a>
        {% else %}
          <em>Aucun lien renseignÃ©</em>
        {% endif %}
      </p>
    {% else %}
      <label class="form-label">
        Le document annexe 1bis est-il bien actualisÃ© et disponible dans le Drive ?
      </label>
      <div class="input-group">
        <input type="url" class="form-control" name="drive_link"
               id="drive_link" value="{{ fiche.get('drive_link','') }}"
               placeholder="https://drive.google.com/...">
        <button class="btn btn-outline-primary" type="button"
                onclick="verifierDriveLink()">ğŸ”— VÃ©rifier</button>
      </div>
    {% endif %}
  </div>
</div>

<script>
function verifierDriveLink() {
  const url = document.getElementById("drive_link").value.trim();
  if (!url) {
    alert("âš ï¸ Aucun lien renseignÃ©.");
    return;
  }
  if (!url.startsWith("https://drive.google.com/")) {
    alert("âŒ Ce lien ne semble pas Ãªtre un lien Google Drive valide.");
    return;
  }
  window.open(url, "_blank");
}
</script>
